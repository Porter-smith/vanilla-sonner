<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vanilla JavaScript Toast Notification</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
    <div id="toastContainer" class="fixed block w-full group z-[99] sm:max-w-xs right-0 bottom-0 sm:mr-6 sm:mb-6"></div>

    <script>
        // Toast constructor function
        function Toast(message, options) {
            this.id = 'toast-' + Math.random().toString(16).slice(2);
            this.message = message;
            this.description = options.description || '';
            this.type = options.type || 'default';
            this.html = options.html || '';
        }

        // Toast manager object
        const toastManager = {
            toasts: [],
            toastContainer: document.getElementById('toastContainer'),
            toastsHovered: false,
            expanded: false,
            layout: 'default',
            position: 'bottom-right',
            paddingBetweenToasts: 15,
            createToast: function (message, options) {
                const toast = new Toast(message, options);
                this.toasts.unshift(toast);
                this.renderToast(toast);
            },

            renderToast: function (toast) {
                const toastElement = document.createElement('div');
                toastElement.id = toast.id;
                toastElement.classList.add('absolute', 'w-full', 'duration-300', 'ease-out', 'select-none', 'sm:max-w-xs');
                if (!toast.description) {
                    toastElement.classList.add('toast-no-description');
                }

                toastElement.innerHTML = `
          <span class="relative flex flex-col items-start shadow-[0_5px_15px_-3px_rgb(0_0_0_/_0.08)] w-full transition-all duration-300 ease-out bg-white border border-gray-100 sm:rounded-md sm:max-w-xs group ${toast.html ? 'p-0' : 'p-4'}">
            ${toast.html ? `<div>${toast.html}</div>` : `
              <div class="relative">
                <div class="flex items-center ${toast.type === 'success' ? 'text-green-500' : toast.type === 'info' ? 'text-blue-500' : toast.type === 'warning' ? 'text-orange-400' : toast.type === 'danger' ? 'text-red-500' : 'text-gray-800'}">
                  ${toast.type === 'success' ? `
                    <svg class="w-[18px] h-[18px] mr-1.5 -ml-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2ZM16.7744 9.63269C17.1238 9.20501 17.0604 8.57503 16.6327 8.22559C16.2051 7.87615 15.5751 7.93957 15.2256 8.36725L10.6321 13.9892L8.65936 12.2524C8.24484 11.8874 7.61295 11.9276 7.248 12.3421C6.88304 12.7566 6.92322 13.3885 7.33774 13.7535L9.31046 15.4903C10.1612 16.2393 11.4637 16.1324 12.1808 15.2547L16.7744 9.63269Z" fill="currentColor"></path>
                    </svg>
                  ` : ''}
                  <p class="text-[13px] font-medium leading-none text-gray-800">${toast.message}</p>
                </div>
                ${toast.description ? `<p class="mt-1.5 text-xs leading-none opacity-70 ${toast.type !== 'default' ? 'pl-5' : ''}">${toast.description}</p>` : ''}
              </div>
            `}
            <span class="absolute right-0 p-1.5 mr-2.5 text-gray-400 duration-100 ease-in-out rounded-full opacity-0 cursor-pointer hover:bg-gray-50 hover:text-gray-500 top-1/2 -translate-y-1/2">
              <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
              </svg>
            </span>
          </span>
        `;

                toastElement.querySelector('span').addEventListener('click', () => {
                    this.removeToast(toast.id);
                });

                toastElement.addEventListener('mouseover', () => {
                    toastElement.querySelector('span').classList.add('opacity-100');
                });

                toastElement.addEventListener('mouseout', () => {
                    toastElement.querySelector('span').classList.remove('opacity-100');
                });

                this.toastContainer.appendChild(toastElement);

                setTimeout(() => {
                    if (this.position.includes('bottom')) {
                        toastElement.firstElementChild.classList.add('toast-bottom', 'opacity-0', 'translate-y-full');
                    } else {
                        toastElement.firstElementChild.classList.add('opacity-0', '-translate-y-full');
                    }

                    setTimeout(() => {
                        if (this.position.includes('bottom')) {
                            toastElement.firstElementChild.classList.remove('opacity-0', 'translate-y-full');
                        } else {
                            toastElement.firstElementChild.classList.remove('opacity-0', '-translate-y-full');
                        }
                        toastElement.firstElementChild.classList.add('opacity-100', 'translate-y-0');

                        setTimeout(() => {
                            this.stackToasts();
                        }, 10);
                    }, 5);
                }, 50);

                setTimeout(() => {
                    setTimeout(() => {
                        toastElement.firstElementChild.classList.remove('opacity-100');
                        toastElement.firstElementChild.classList.add('opacity-0');
                        if (this.toasts.length === 1) {
                            toastElement.firstElementChild.classList.remove('translate-y-0');
                            toastElement.firstElementChild.classList.add('-translate-y-full');
                        }
                        setTimeout(() => {
                            this.removeToast(toast.id);
                        }, 300);
                    }, 5);
                }, 4000);
            },

            removeToast: function (toastId) {
                const toastElement = document.getElementById(toastId);
                if (toastElement) {
                    toastElement.remove();
                }
                this.toasts = this.toasts.filter(toast => toast.id !== toastId);
                this.stackToasts();
            },

            stackToasts: function () {
                this.positionToasts();
                this.calculateHeightOfToastsContainer();
                setTimeout(() => {
                    this.calculateHeightOfToastsContainer();
                }, 300);
            },

            positionToasts: function () {
                if (this.toasts.length === 0) return;

                const topToast = document.getElementById(this.toasts[0].id);
                topToast.style.zIndex = '100';
                if (this.expanded) {
                    if (this.position.includes('bottom')) {
                        topToast.style.top = 'auto';
                        topToast.style.bottom = '0px';
                    } else {
                        topToast.style.top = '0px';
                    }
                }

                if (this.toasts.length === 1) return;

                const middleToast = document.getElementById(this.toasts[1].id);
                middleToast.style.zIndex = '90';

                if (this.expanded) {
                    const middleToastPosition = topToast.getBoundingClientRect().height + this.paddingBetweenToasts + 'px';
                    if (this.position.includes('bottom')) {
                        middleToast.style.top = 'auto';
                        middleToast.style.bottom = middleToastPosition;
                    } else {
                        middleToast.style.top = middleToastPosition;
                    }
                    middleToast.style.transform = 'translateY(0px)';
                } else {
                    middleToast.style.transform = this.position.includes('bottom') ? 'translateY(-16px)' : 'translateY(16px)';
                }

                if (this.toasts.length === 2) return;

                const bottomToast = document.getElementById(this.toasts[2].id);
                bottomToast.style.zIndex = '80';

                if (this.expanded) {
                    const bottomToastPosition = topToast.getBoundingClientRect().height + this.paddingBetweenToasts + middleToast.getBoundingClientRect().height + this.paddingBetweenToasts + 'px';
                    if (this.position.includes('bottom')) {
                        bottomToast.style.top = 'auto';
                        bottomToast.style.bottom = bottomToastPosition;
                    } else {
                        bottomToast.style.top = bottomToastPosition;
                    }
                    bottomToast.style.transform = 'translateY(0px)';
                } else {
                    bottomToast.style.transform = this.position.includes('bottom') ? 'translateY(-32px)' : 'translateY(32px)';
                }

                if (this.toasts.length === 3) return;

                const burnToast = document.getElementById(this.toasts[3].id);
                burnToast.style.zIndex = '70';

                if (this.expanded) {
                    const burnToastPosition = topToast.getBoundingClientRect().height + this.paddingBetweenToasts + middleToast.getBoundingClientRect().height + this.paddingBetweenToasts + bottomToast.getBoundingClientRect().height + this.paddingBetweenToasts + 'px';
                    if (this.position.includes('bottom')) {
                        burnToast.style.top = 'auto';
                        burnToast.style.bottom = burnToastPosition;
                    } else {
                        burnToast.style.top = burnToastPosition;
                    }
                    burnToast.style.transform = 'translateY(0px)';
                } else {
                    burnToast.style.transform = 'translateY(48px)';
                }

                burnToast.firstElementChild.classList.remove('opacity-100');
                burnToast.firstElementChild.classList.add('opacity-0');

                setTimeout(() => {
                    this.toasts.pop();
                }, 300);
            },

            calculateHeightOfToastsContainer: function () {
                if (this.toasts.length === 0) {
                    this.toastContainer.style.height = '0px';
                    return;
                }

                const lastToast = this.toasts[this.toasts.length - 1];
                const lastToastRectangle = document.getElementById(lastToast.id).getBoundingClientRect();

                const firstToast = this.toasts[0];
                const firstToastRectangle = document.getElementById(firstToast.id).getBoundingClientRect();

                if (this.expanded) {
                    if (this.position.includes('bottom')) {
                        this.toastContainer.style.height = (firstToastRectangle.top + firstToastRectangle.height - lastToastRectangle.top) + 'px';
                    } else {
                        this.toastContainer.style.height = (lastToastRectangle.top + lastToastRectangle.height - firstToastRectangle.top) + 'px';
                    }
                } else {
                    this.toastContainer.style.height = firstToastRectangle.height + 'px';
                }
            }
        };

        // Event listeners for hover expansion
        toastManager.toastContainer.addEventListener('mouseenter', () => {
            toastManager.toastsHovered = true;
            toastManager.expanded = true;
            toastManager.stackToasts();
        });

        toastManager.toastContainer.addEventListener('mouseleave', () => {
            toastManager.toastsHovered = false;
            toastManager.expanded = false;
            toastManager.stackToasts();
        });

        // Event listener for the 'toast-show' event
        window.addEventListener('toast-show', function (event) {
            const { message, description, type, position, html } = event.detail;
            toastManager.createToast(message, { description, type, position, html });
        });

        // Example usage
        window.dispatchEvent(new CustomEvent('toast-show', {
            detail: {
                message: 'Success Notification',
                type: 'success',
                position: 'bottom-right'
            }
        }));
        // Example usage
        window.dispatchEvent(new CustomEvent('toast-show', {
            detail: {
                message: 'Success Notification',
                type: 'success',
                position: 'bottom-right'
            }
        }));
        // Example usage
        window.dispatchEvent(new CustomEvent('toast-show', {
            detail: {
                message: 'Success Notification',
                type: 'success',
                position: 'bottom-right'
            }
        }));
    </script>
</body>

</html>